<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.9.4/css/bulma.min.css">
    <link rel="stylesheet" href="{{url_for('static', filename='styles.css')}}">
    <link href="https://cdn.jsdelivr.net/npm/hint.css@3.0.0/hint.min.css" rel="stylesheet">
    <script>
        function handleMenuChange() {
            var mainMenu = document.getElementById('main-menu');
            var unsubscribeOptions = document.getElementById('unsubscribe-options');
            var submitButton = document.getElementById('submit-button');
            
            // If 'Unsubscribe from emails' is selected, show submenu and disable submit
            if (mainMenu.value === 'unsubscribe-emails') {
                unsubscribeOptions.style.display = 'block';
                submitButton.disabled = true; // Disable submit button initially
            } else {
                unsubscribeOptions.style.display = 'none';
                submitButton.disabled = false; // Enable submit button for other options
            }
        }
    
        function handleSubmenuChange() {
            var unsubscribeMenu = document.getElementById('unsubscribe-menu');
            var submitButton = document.getElementById('submit-button');
            
            // Enable submit button if a valid option is selected in the submenu
            if (unsubscribeMenu.value !== '') {
                submitButton.disabled = false;
            } else {
                submitButton.disabled = true;
            }
        }
    </script>
    <title>POPROX Newsletter</title>
	{% block header %}
	{% endblock %}

</head>

<body>
    <div class="block box">
        POPROX Newsletter
    </div>
    <div class="container">
        <div class="columns is-mobile">
            <form action="{{url_for('pre_unsubscribe')}}" method="post">
                <p>
                    Sorry to see you go! <br>
                    <div class="block">
                        <div class="field">
                            <label class="label">Choose an option:</label>
                            <div class="control">
                                <div class="select">
                                    <select name="main-menu" id="main-menu" onchange="handleMenuChange()">
                                        <option value="">-- Select an option --</option>
                                        <option value="leave-experiment">Leave Experiment</option>
                                        <option value="unsubscribe-emails">Unsubscribe from emails</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                
                        <!-- Submenu for Unsubscribe from Emails -->
                        <div id="unsubscribe-options" class="field" style="display:none;">
                            <label class="label">Choose an unsubscribe option:</label>
                            <div class="control">
                                <div class="select">
                                    <select id="unsubscribe-menu" name="unsubscribe-menu" onchange="handleSubmenuChange()">
                                        <option value="">-- Select an option --</option>
                                        <option value="remove-email">Remove email/revoke consent/remove subscription</option>
                                        <option value="withdraw-email-poprox">Withdraw email from POPROX</option>
                                        <option value="withdraw-all-data">Withdraw all data</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                    </div>
                </p>
                <div class="control">
                    <button class="button is-link">Submit</button>
                </div>
            </form>
            {% block content %}
            {% endblock %}
        </div>
    </div>

</body>